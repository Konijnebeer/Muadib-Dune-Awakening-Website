<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muadib Builder</title>
    <link href="src/output.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <script src="js/builder.js" defer></script>
    <style>
        @font-face {
            font-family: 'Dune Rise';
            src: url('fonts/Dune_Rise.ttf') format('truetype');
        }
        body {
            font-family: 'Dune Rise', sans-serif;
        }
        .normal-font {
            font-family: 'Open Sans', sans-serif;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen text-purple-900">
    <header class="header-styles p-4 flex items-center">
        <div class="flex items-center w-full max-w-screen-md mx-auto ml-0">
            <a href="index.html" class="flex items-center hover:opacity-80 transition-opacity">
                <img src="images/Muadib.png" alt="Logo" class="h-8 mr-4">
                <h1 class="text-xl font-bold">Muadib</h1>
            </a>
        </div>
    </header>
    <main class="container mx-auto p-4 w-4/5 max-w-6xl">
        <div class="flex flex-row gap-4">
            <!-- Main builder section -->
            <section id="builder-content" class="flex flex-col justify-start items-center relative w-3/4">
                <div class="bg-white/20 backdrop-blur rounded-lg p-6 shadow-lg w-full">
                    <h2 class="text-xl mb-4 font-semibold">Base Builder</h2>
                    
                    <div class="normal-font">
                        <!-- Canvas with cream background -->
                        <div class="w-full rounded-xl overflow-hidden mb-4 shadow-lg relative" style="background-color: #f8f4e5;">
                            <canvas id="builder-canvas" class="block w-full h-[600px]"></canvas>
                            
                            <!-- Repositioned zoom controls inside canvas container with proper styling -->
                            <div id="canvas-controls" class="absolute flex flex-col items-center justify-center gap-2 p-2" style="top: 10px; right: 10px;">
                                <button id="zoom-in-btn" title="Zoom In" 
                                        class="flex items-center justify-center w-[50px] h-[50px] p-2 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="12" y1="5" x2="12" y2="19"></line>
                                        <line x1="5" y1="12" x2="19" y2="12"></line>
                                    </svg>
                                </button>
                                <button id="zoom-out-btn" title="Zoom Out"
                                        class="flex items-center justify-center w-[50px] h-[50px] p-2 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="5" y1="12" x2="19" y2="12"></line>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Buttons with shape icons -->
                        <div class="flex justify-between mt-4">
                            <div class="flex">
                                <!-- Square button -->
                                <button id="square-btn" title="Square (1)" 
                                        class="flex items-center justify-center w-[60px] h-[60px] mx-2 p-3 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="5" y="5" width="20" height="20" stroke="#7e22ce" stroke-width="2" fill="none"/>
                                    </svg>
                                </button>
                                
                                <!-- Equal-sided triangle button -->
                                <button id="triangle-btn" title="Equal-sided Triangle (2)" 
                                        class="flex items-center justify-center w-[60px] h-[60px] mx-2 p-3 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M15 5 L27 25 L3 25 Z" stroke="#7e22ce" stroke-width="2" fill="none"/>
                                    </svg>
                                </button>
                                
                                <!-- Right triangle (half square) button -->
                                <button id="right-triangle-btn" title="Right Triangle (3)" 
                                        class="flex items-center justify-center w-[60px] h-[60px] mx-2 p-3 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M5 5 L25 5 L5 25 Z" stroke="#7e22ce" stroke-width="2" fill="none"/>
                                    </svg>
                                </button>

                                <!-- Hand icon for select mode -->
                                <button id="select-btn" title="Select Mode (4)" 
                                        class="flex items-center justify-center w-[60px] h-[60px] mx-2 p-3 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0"></path>
                                        <path d="M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2"></path>
                                        <path d="M10 10.3V5a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v10"></path>
                                        <path d="M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"></path>
                                    </svg>
                                </button>
                            </div>

                            <div class="flex">
                                <!-- Settings button -->
                                <button id="settings-btn" title="Settings" 
                                        class="flex items-center justify-center w-[60px] h-[60px] mx-2 p-3 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="3"></circle>
                                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                                    </svg>
                                </button>
                                
                                <!-- Save button -->
                                <button id="save-btn" title="Save Canvas" 
                                        class="flex items-center justify-center w-[60px] h-[60px] mx-2 p-3 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                        <polyline points="7 3 7 8 15 8"></polyline>
                                    </svg>
                                </button>
                                
                                <!-- Load button -->
                                <button id="load-btn" title="Load Canvas" 
                                        class="flex items-center justify-center w-[60px] h-[60px] mx-2 p-3 
                                            bg-white/20 backdrop-blur rounded-lg 
                                            border border-white/20 
                                            transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                            shadow-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Warning info box - moved outside the main builder box -->
                <div class="bg-white/20 backdrop-blur border border-white/20 rounded-lg shadow-lg p-4 mt-4 w-full">
                    <h3 class="text-lg font-bold text-purple-900 mb-2">Warning!</h3>
                    <p class="normal-font text-sm text-purple-900">
                        This tool is still very much a work in progress. Some snapping logic doesn't work properly yet, particularly with large group selections, and the right triangle can be buggy at times. All your designs are saved locally, but I cannot guarantee they will exist forever or that save files won't change in future updates. Please take screenshots of your designs to preserve them safely.
                    </p>
                </div>
            </section>

            <!-- Separate tutorial section -->
            <section id="tutorial-panel" class="w-1/4 normal-font">
                <div class="glass-modal bg-white/40! p-4 rounded-lg h-[600px] overflow-y-auto sticky top-4">
                    <h3 class="text-lg font-semibold mb-3 text-purple-900">How to Use</h3>
                    
                    <div class="space-y-4 text-sm">
                        <div>
                            <h4 class="font-semibold mb-1">Adding Shapes</h4>
                            <p>Select a shape button or use number keys (1, 2, 3) then click on the canvas to place.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-1">Moving Shapes</h4>
                            <p>Click on a shape to select it, then drag to move. Selected shapes are highlighted in orange.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-1">Rotating Shapes</h4>
                            <p>With a shape selected, use your mouse wheel to rotate it. Shapes automatically align when sides match.</p>
                        </div>

                        <div>
                            <h4 class="font-semibold mb-1">Deleting Shapes</h4>
                            <p>Select a shape and press the Backspace key to remove it.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-1">Saving Your Design</h4>
                            <p>Click the save button to store your current canvas. Enter a name in the dialog that appears.</p>
                            <p>Saving with an existing name will update that design.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-1">Loading Designs</h4>
                            <p>Click the load button to view your saved designs. Click on any saved design to load it.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-1">Keyboard Shortcuts</h4>
                            <ul class="list-disc list-inside pl-2">
                                <li><b>1:</b> Select square</li>
                                <li><b>2:</b> Select equilateral triangle</li>
                                <li><b>3:</b> Select right triangle</li>
                                <li><b>4:</b> Select mode</li>
                                <li><b>Backspace:</b> Delete selected shape</li>
                                <li><b>R:</b> Rotate clockwise</li>
                                <li><b>Shift+R:</b> Rotate counterclockwise</li>
                                <li><b>Ctrl+C:</b> Copy</li>
                                <li><b>Ctrl+V:</b> Paste</li>
                                <li><b>Ctrl+Z:</b> Undo</li>
                                <li><b>Ctrl+Y:</b> Redo</li>
                                <li><b>Ctrl+Click:</b> Multi-select</li>
                                <li><b>Ctrl+G:</b> Group selected shapes</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-1">Navigation</h4>
                            <p>Use the zoom buttons (+/-) to zoom in and out. Hold right-click and drag to pan around the canvas.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-1">Smart Snapping</h4>
                            <p>Shapes will automatically snap and align when sides match, making it easy to create perfect patterns.</p>
                        </div>
                        
                        <!-- Add "Understood" button at bottom of tutorial -->
                        <div class="mt-6 flex justify-center">
                            <button id="understood-btn" 
                                    class="px-6 py-3 rounded-lg text-purple-900 font-semibold
                                          bg-white/20 backdrop-blur
                                          border border-white/20
                                          shadow-md hover:shadow-purple-300/50
                                          transition-all duration-300 hover:-translate-y-0.5 hover:bg-white/30">
                                Understood
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Save Modal -->
        <div id="save-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
            <div class="absolute inset-0 bg-transparent pointer-events-auto backdrop-blur"></div>
            <div class="glass-modal relative p-6 max-w-md w-full z-10">
                <h3 class="text-xl font-semibold mb-4 text-purple-900">Save Your Canvas</h3>
                <form id="save-form" class="space-y-4 normal-font">
                    <div>
                        <label for="save-name" class="block text-sm font-medium text-purple-900 mb-1">Enter a name for your creation:</label>
                        <input type="text" id="save-name" class="w-full px-4 py-2 rounded-md border border-purple-300 focus:outline-none focus:ring-2 focus:ring-purple-500" 
                               placeholder="My awesome design" required>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" id="cancel-save" class="px-4 py-2 bg-white/20 backdrop-blur text-purple-900 rounded-md border border-white/20 hover:bg-white/30 transition-colors">
                            Cancel
                        </button>
                        <button type="submit" class="px-4 py-2 bg-white/20 backdrop-blur text-purple-900 rounded-md border border-white/20 hover:bg-white/30 transition-colors">
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Load Modal -->
        <div id="load-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
            <div class="absolute inset-0 bg-transparent pointer-events-auto backdrop-blur"></div>
            <div class="glass-modal relative p-6 max-w-md w-full z-10">
                <h3 class="text-xl font-semibold mb-4 text-purple-900">Load Saved Canvas</h3>
                <div id="saved-list" class="max-h-60 overflow-y-auto mb-4 space-y-2 normal-font">
                    <!-- Saved items will be inserted here -->
                </div>
                <div class="flex justify-end space-x-3 normal-font">
                    <button type="button" id="new-canvas-btn" class="px-4 py-2 bg-white/20 backdrop-blur text-purple-900 rounded-md border border-white/20 hover:bg-white/30 transition-colors">
                        New Canvas
                    </button>
                    <button type="button" id="cancel-load" class="px-4 py-2 bg-white/20 backdrop-blur text-purple-900 rounded-md border border-white/20 hover:bg-white/30 transition-colors">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Settings Modal -->
        <div id="settings-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
            <div class="absolute inset-0 bg-transparent pointer-events-auto backdrop-blur"></div>
            <div class="glass-modal relative p-6 max-w-md w-full z-10">
                <h3 class="text-xl font-semibold mb-4 text-purple-900">Settings</h3>
                <div class="space-y-6 normal-font">
                    <div>
                        <p class="text-purple-900 font-medium mb-3">Fief Display Options:</p>
                        
                        <div class="flex items-center justify-between mb-3 normal-font">
                            <span class="text-purple-900">Fief Outline (5x5 center outline)</span>
                            <button id="fief-outline-toggle" 
                                    class="flex items-center justify-center w-[50px] h-[50px] p-2 
                                        bg-white/20 backdrop-blur rounded-lg 
                                        border border-white/20 
                                        transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                        shadow-md relative">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                </svg>
                                <span class="fief-checkmark absolute inset-0 flex items-center justify-center bg-white/40 rounded-lg hidden">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                </span>
                            </button>
                        </div>
                        
                        <div class="flex items-center justify-between mb-3 normal-font">
                            <span class="text-purple-900">Advanced Fief Grid (10x10 repeating)</span>
                            <button id="advanced-fief-grid-toggle" 
                                    class="flex items-center justify-center w-[50px] h-[50px] p-2 
                                        bg-white/20 backdrop-blur rounded-lg 
                                        border border-white/20 
                                        transition-all duration-300 hover:bg-white/30 hover:-translate-y-0.5 
                                        shadow-md relative">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="3" y1="3" x2="21" y2="3"></line>
                                    <line x1="3" y1="9" x2="21" y2="9"></line>
                                    <line x1="3" y1="15" x2="21" y2="15"></line>
                                    <line x1="3" y1="21" x2="21" y2="21"></line>
                                    <line x1="3" y1="3" x2="3" y2="21"></line>
                                    <line x1="9" y1="3" x2="9" y2="21"></line>
                                    <line x1="15" y1="3" x2="15" y2="21"></line>
                                    <line x1="21" y1="3" x2="21" y2="21"></line>
                                </svg>
                                <span class="fief-checkmark absolute inset-0 flex items-center justify-center bg-white/40 rounded-lg hidden">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#7e22ce" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 mt-6 normal-font">
                    <button type="button" id="close-settings" class="px-4 py-2 bg-white/20 backdrop-blur text-purple-900 rounded-md border border-white/20 hover:bg-white/30 transition-colors">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Name Prompt Modal -->
        <div id="name-prompt-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
            <div class="absolute inset-0 bg-transparent pointer-events-auto backdrop-blur"></div>
            <div class="glass-modal relative p-6 max-w-md w-full z-10">
                <h3 class="text-xl font-semibold mb-4 text-purple-900">New Canvas</h3>
                <form id="new-canvas-form" class="space-y-4 normal-font">
                    <div>
                        <label for="canvas-name" class="block text-sm font-medium text-purple-900 mb-1">Name your new canvas:</label>
                        <input type="text" id="canvas-name" class="w-full px-4 py-2 rounded-md border border-purple-300 focus:outline-none focus:ring-2 focus:ring-purple-500" 
                               placeholder="My new design" required>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" id="cancel-new-canvas" class="px-4 py-2 bg-white/20 backdrop-blur text-purple-900 rounded-md border border-white/20 hover:bg-white/30 transition-colors">
                            Cancel
                        </button>
                        <button type="submit" class="px-4 py-2 bg-white/20 backdrop-blur text-purple-900 rounded-md border border-white/20 hover:bg-white/30 transition-colors">
                            Create
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>
    
    <footer class="footer-styles p-4 mt-auto flex items-center justify-start gap-4">
        <div class="bg-white/20 backdrop-blur rounded-lg p-4 shadow-lg text-center">
            <p class="text-sm text-purple-900 mb-2">Fan Site</p>
            <a href="https://github.com/konijnebeer" target="_blank" 
               class="px-4 py-2 rounded-lg text-purple-900 font-semibold
                      bg-white/20 backdrop-blur
                      border border-white/20
                      shadow-md hover:shadow-purple-300/50
                      transition-all duration-300 hover:-translate-y-0.5 hover:bg-white/30">
                GitHub
            </a>
        </div>
        <div class="bg-white/20 backdrop-blur rounded-lg p-4 shadow-lg text-center max-w-xs">
            <p class="text-sm text-purple-900 normal-font">This is a fan site. Not endorsed or affiliated with the Dune franchise, Funcom, or Dune Awakening.</p>
        </div>
    </footer>
</body>
</html>
